SELECT oc.END_CIDADE AS CIDADE
FROM ORDEM_DE_COMPRA oc, COMPRA_PRODUTO cp
WHERE oc.CODORDEM = cp.CODIGO_COMPRA
GROUP BY oc.END_CIDADE
HAVING AVG(cp.VALOR_ATUAL) > 240